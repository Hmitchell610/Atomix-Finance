<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Atomix Finance</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg-primary: #080c0a;
    --bg-card: rgba(16, 24, 18, 0.6);
    --bg-card-hover: rgba(20, 32, 22, 0.8);
    --border-glow: rgba(120, 255, 170, 0.25);
    --border-glow-hover: rgba(120, 255, 170, 0.45);
    --accent: #7affaa;
    --accent-dim: #5ad88a;
    --text-primary: #e8ede9;
    --text-secondary: #9ca89e;
    --text-label: #7affaa;
    --input-bg: rgba(10, 16, 12, 0.8);
    --input-border: rgba(120, 255, 170, 0.15);
    --overlay-bg: rgba(4, 6, 5, 0.85);
  }

  body {
    font-family: 'Inter', -apple-system, sans-serif;
    background: var(--bg-primary);
    color: var(--text-primary);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Ambient background glow */
  body::before {
    content: '';
    position: fixed;
    top: -200px;
    left: 50%;
    transform: translateX(-50%);
    width: 800px;
    height: 600px;
    background: radial-gradient(ellipse, rgba(120, 255, 170, 0.06) 0%, transparent 70%);
    pointer-events: none;
    z-index: 0;
  }

  .container {
    max-width: 960px;
    margin: 0 auto;
    padding: 0 24px;
    position: relative;
    z-index: 1;
  }

  /* ── Hero ── */
  .hero {
    text-align: center;
    padding: 80px 0 60px;
  }

  .badge {
    display: inline-block;
    padding: 8px 24px;
    border: 1px solid var(--border-glow);
    border-radius: 999px;
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 3px;
    color: var(--accent);
    text-transform: uppercase;
    background: rgba(120, 255, 170, 0.04);
    box-shadow: 0 0 20px rgba(120, 255, 170, 0.08);
    margin-bottom: 32px;
  }

  .hero h1 {
    font-size: clamp(48px, 10vw, 96px);
    font-weight: 300;
    line-height: 1.05;
    letter-spacing: -2px;
    margin-bottom: 20px;
    color: var(--text-primary);
  }

  .hero .tagline {
    font-size: 14px;
    font-weight: 400;
    letter-spacing: 4px;
    text-transform: uppercase;
    color: var(--text-secondary);
    line-height: 1.8;
  }

  /* ── Module Grid ── */
  .module-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
    padding-bottom: 80px;
    margin-top: 20px;
  }

  @media (max-width: 640px) {
    .module-grid { grid-template-columns: 1fr; }
  }

  .module-card {
    position: relative;
    background: var(--bg-card);
    border: 1px solid var(--border-glow);
    border-radius: 16px;
    padding: 32px;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(12px);
    overflow: hidden;
  }

  .module-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--accent), transparent);
    opacity: 0.3;
  }

  .module-card::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(ellipse at center, rgba(120, 255, 170, 0.03) 0%, transparent 60%);
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
  }

  .module-card:hover {
    background: var(--bg-card-hover);
    border-color: var(--border-glow-hover);
    transform: translateY(-2px);
    box-shadow: 0 8px 32px rgba(120, 255, 170, 0.08);
  }

  .module-card:hover::after { opacity: 1; }

  .module-label {
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-label);
    margin-bottom: 10px;
  }

  .module-title {
    font-size: 28px;
    font-weight: 300;
    margin-bottom: 8px;
    color: var(--text-primary);
  }

  .module-desc {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.5;
  }

  .module-arrow {
    position: absolute;
    top: 32px;
    right: 32px;
    font-size: 20px;
    color: var(--accent);
    transition: transform 0.3s ease;
  }

  .module-card:hover .module-arrow { transform: translateX(4px); }

  /* ── Modal Overlay ── */
  .modal-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: var(--overlay-bg);
    z-index: 1000;
    justify-content: center;
    align-items: center;
    padding: 24px;
    backdrop-filter: blur(8px);
    animation: fadeIn 0.25s ease;
  }

  .modal-overlay.active { display: flex; }

  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  @keyframes slideUp { from { opacity: 0; transform: translateY(24px); } to { opacity: 1; transform: translateY(0); } }

  .modal {
    background: linear-gradient(180deg, rgba(14, 22, 16, 0.98) 0%, rgba(8, 12, 10, 0.99) 100%);
    border: 1px solid var(--border-glow);
    border-radius: 20px;
    width: 100%;
    max-width: 720px;
    max-height: 90vh;
    overflow-y: auto;
    padding: 40px;
    position: relative;
    animation: slideUp 0.3s ease;
    box-shadow: 0 0 60px rgba(120, 255, 170, 0.06);
  }

  .modal::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--accent), transparent);
    opacity: 0.4;
  }

  .modal-close {
    position: absolute;
    top: 20px;
    right: 24px;
    background: none;
    border: none;
    color: var(--text-secondary);
    font-size: 24px;
    cursor: pointer;
    padding: 8px;
    transition: color 0.2s;
    line-height: 1;
  }

  .modal-close:hover { color: var(--text-primary); }

  .modal .module-label { margin-bottom: 6px; }
  .modal .module-title { font-size: 32px; margin-bottom: 28px; }

  /* ── Form Styles ── */
  .form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 28px;
  }

  .form-grid .full-width { grid-column: 1 / -1; }

  .form-group label {
    display: block;
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-label);
    margin-bottom: 8px;
  }

  .form-group input,
  .form-group select,
  .form-group textarea {
    width: 100%;
    padding: 12px 16px;
    background: var(--input-bg);
    border: 1px solid var(--input-border);
    border-radius: 10px;
    color: var(--text-primary);
    font-family: 'Inter', sans-serif;
    font-size: 14px;
    transition: border-color 0.2s;
    outline: none;
  }

  .form-group input::placeholder,
  .form-group textarea::placeholder {
    color: var(--text-secondary);
    opacity: 0.6;
  }

  .form-group input:focus,
  .form-group select:focus,
  .form-group textarea:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 2px rgba(120, 255, 170, 0.1);
  }

  .form-group select {
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%239ca89e' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 16px center;
    padding-right: 40px;
  }

  .form-group select option {
    background: #0e1610;
    color: var(--text-primary);
  }

  .form-group textarea { resize: vertical; min-height: 80px; }

  .form-actions {
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    margin-top: 8px;
  }

  .btn {
    padding: 12px 28px;
    border-radius: 10px;
    font-family: 'Inter', sans-serif;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    border: none;
  }

  .btn-ghost {
    background: transparent;
    border: 1px solid rgba(120, 255, 170, 0.2);
    color: var(--text-secondary);
  }

  .btn-ghost:hover {
    border-color: var(--border-glow-hover);
    color: var(--text-primary);
  }

  .btn-primary {
    background: var(--accent);
    color: #080c0a;
    font-weight: 600;
  }

  .btn-primary:hover {
    background: #90ffba;
    box-shadow: 0 4px 20px rgba(120, 255, 170, 0.25);
  }

  /* ── Data Log Table ── */
  .log-section { margin-top: 32px; }

  .log-title {
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-label);
    margin-bottom: 16px;
  }

  .log-table {
    width: 100%;
    border-collapse: collapse;
  }

  .log-table thead th {
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--text-label);
    text-align: left;
    padding: 10px 12px;
    border-bottom: 1px solid var(--input-border);
  }

  .log-table tbody td {
    font-size: 13px;
    color: var(--text-secondary);
    padding: 10px 12px;
    border-bottom: 1px solid rgba(120, 255, 170, 0.06);
  }

  .log-table tbody tr:hover td { color: var(--text-primary); }

  .log-empty {
    text-align: center;
    color: var(--text-secondary);
    padding: 24px 0;
    font-size: 14px;
    opacity: 0.6;
  }

  /* ── File Upload Area ── */
  .upload-dropzone {
    border: 2px dashed var(--input-border);
    border-radius: 12px;
    padding: 28px 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
    background: var(--input-bg);
  }

  .upload-dropzone:hover,
  .upload-dropzone.drag-over {
    border-color: var(--accent);
    background: rgba(120, 255, 170, 0.04);
  }

  .upload-icon {
    font-size: 28px;
    color: var(--accent);
    margin-bottom: 8px;
  }

  .upload-text {
    font-size: 14px;
    color: var(--text-primary);
    margin-bottom: 4px;
  }

  .upload-hint {
    font-size: 12px;
    color: var(--text-secondary);
    opacity: 0.7;
  }

  .file-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 12px;
  }

  .file-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 14px;
    background: var(--input-bg);
    border: 1px solid var(--input-border);
    border-radius: 8px;
    font-size: 13px;
    color: var(--text-primary);
  }

  .file-item-name {
    display: flex;
    align-items: center;
    gap: 8px;
    overflow: hidden;
  }

  .file-item-name span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .file-item-size {
    font-size: 11px;
    color: var(--text-secondary);
    margin-left: 8px;
    flex-shrink: 0;
  }

  .file-remove {
    background: none;
    border: none;
    color: var(--text-secondary);
    font-size: 16px;
    cursor: pointer;
    padding: 2px 6px;
    border-radius: 4px;
    transition: color 0.2s;
    flex-shrink: 0;
  }

  .file-remove:hover { color: #ff7a7a; }

  /* Auto-calc field */
  .auto-field {
    background: rgba(120, 255, 170, 0.04) !important;
    border-style: dashed !important;
    cursor: not-allowed;
  }

  /* Success flash */
  @keyframes successFlash {
    0% { box-shadow: 0 0 0 0 rgba(120, 255, 170, 0.4); }
    50% { box-shadow: 0 0 24px 4px rgba(120, 255, 170, 0.15); }
    100% { box-shadow: none; }
  }

  .flash { animation: successFlash 0.6s ease; }
</style>
</head>
<body>

<!-- ════════ HERO ════════ -->
<div class="container">
  <section class="hero">
    <div class="badge">Finance Platform</div>
    <h1>Atomix<br>Finance</h1>
    <div class="tagline">
      First Class<br>Cutting Edge
    </div>
  </section>

  <!-- ════════ MODULE GRID ════════ -->
  <div class="module-grid">

    <div class="module-card" onclick="openModal('credit')">
      <div class="module-label">Module</div>
      <div class="module-title">Client Credit Submissions</div>
      <div class="module-desc">Submit, track, and manage client credit requests and approvals.</div>
      <div class="module-arrow">&rarr;</div>
    </div>

    <div class="module-card" onclick="openModal('packaging')">
      <div class="module-label">Module</div>
      <div class="module-title">Custom Packaging</div>
      <div class="module-desc">Log custom packaging requests, costs, and specifications.</div>
      <div class="module-arrow">&rarr;</div>
    </div>

    <div class="module-card" onclick="openModal('orders')">
      <div class="module-label">Module</div>
      <div class="module-title">Order Analysis</div>
      <div class="module-desc">Analyze order volume, revenue, and trends by client.</div>
      <div class="module-arrow">&rarr;</div>
    </div>

    <div class="module-card" onclick="openModal('ratecard')">
      <div class="module-label">Module</div>
      <div class="module-title">Client Rate Card Adjustments</div>
      <div class="module-desc">Track and manage rate card changes, pricing updates, and client billing adjustments.</div>
      <div class="module-arrow">&rarr;</div>
    </div>

  </div>
</div>

<!-- ════════════════════════════════════════
     MODAL — Client Credit Submissions
     ════════════════════════════════════════ -->
<div class="modal-overlay" id="modal-credit">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('credit')">&times;</button>
    <div class="module-label">Module</div>
    <div class="module-title">Client Credit Submissions</div>

    <form id="form-credit" onsubmit="return submitCredit(event)">
      <div class="form-grid">
        <div class="form-group">
          <label>Client Name</label>
          <input type="text" placeholder="Client name" required>
        </div>
        <div class="form-group">
          <label>Date</label>
          <input type="date" required>
        </div>
        <div class="form-group">
          <label>Order / Reference #</label>
          <input type="text" placeholder="ORD-XXXX">
        </div>
        <div class="form-group">
          <label>Credit Amount ($)</label>
          <input type="number" step="0.01" placeholder="0.00" required>
        </div>
        <div class="form-group">
          <label>Reason</label>
          <select required>
            <option value="" disabled selected>Select reason</option>
            <option>Damaged Goods</option>
            <option>Billing Error</option>
            <option>Late Delivery</option>
            <option>Wrong Item Shipped</option>
            <option>Pricing Discrepancy</option>
            <option>Other</option>
          </select>
        </div>
        <div class="form-group">
          <label>Submitted By</label>
          <input type="text" placeholder="Your name">
        </div>
        <div class="form-group full-width">
          <label>Notes</label>
          <textarea placeholder="Additional details or context..."></textarea>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-ghost" onclick="closeModal('credit')">Cancel</button>
        <button type="submit" class="btn btn-primary">Submit Credit &rarr;</button>
      </div>
    </form>

    <div class="log-section">
      <div class="log-title">Credit Log</div>
      <table class="log-table">
        <thead>
          <tr>
            <th>Client</th>
            <th>Date</th>
            <th>Ref #</th>
            <th>Amount</th>
            <th>Reason</th>
            <th>By</th>
          </tr>
        </thead>
        <tbody id="credit-log-body">
        </tbody>
      </table>
      <div class="log-empty" id="credit-empty">No credits submitted yet.</div>
    </div>
  </div>
</div>

<!-- ════════════════════════════════════════
     MODAL — Custom Packaging
     ════════════════════════════════════════ -->
<div class="modal-overlay" id="modal-packaging">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('packaging')">&times;</button>
    <div class="module-label">Module</div>
    <div class="module-title">Custom Packaging</div>

    <form id="form-packaging" onsubmit="return submitPackaging(event)">
      <div class="form-grid">
        <div class="form-group">
          <label>Client Name</label>
          <input type="text" placeholder="Client name" required>
        </div>
        <div class="form-group">
          <label>Date</label>
          <input type="date" required>
        </div>
        <div class="form-group">
          <label>SKU / Product</label>
          <input type="text" placeholder="SKU or product name">
        </div>
        <div class="form-group">
          <label>Packaging Type</label>
          <select required>
            <option value="" disabled selected>Select type</option>
            <option>Custom Box</option>
            <option>Poly Mailer</option>
            <option>Branded Insert</option>
            <option>Tissue / Wrap</option>
            <option>Gift Box</option>
            <option>Other</option>
          </select>
        </div>
        <div class="form-group">
          <label>Start Date</label>
          <input type="date" required>
        </div>
        <div class="form-group">
          <label>Cost ($)</label>
          <input type="number" step="0.01" placeholder="0.00">
        </div>
        <div class="form-group">
          <label>Requested By</label>
          <input type="text" placeholder="Your name">
        </div>
        <div class="form-group full-width">
          <label>Specifications / Notes</label>
          <textarea placeholder="Dimensions, branding details, special instructions..."></textarea>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-ghost" onclick="closeModal('packaging')">Cancel</button>
        <button type="submit" class="btn btn-primary">Log Packaging &rarr;</button>
      </div>
    </form>

    <div class="log-section">
      <div class="log-title">Packaging Log</div>
      <table class="log-table">
        <thead>
          <tr>
            <th>Client</th>
            <th>Date</th>
            <th>SKU</th>
            <th>Type</th>
            <th>Start Date</th>
            <th>Cost</th>
          </tr>
        </thead>
        <tbody id="packaging-log-body">
        </tbody>
      </table>
      <div class="log-empty" id="packaging-empty">No packaging logged yet.</div>
    </div>
  </div>
</div>

<!-- ════════════════════════════════════════
     MODAL — Order Analysis
     ════════════════════════════════════════ -->
<div class="modal-overlay" id="modal-orders">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('orders')">&times;</button>
    <div class="module-label">Module</div>
    <div class="module-title">Order Analysis</div>

    <form id="form-orders" onsubmit="return submitOrder(event)">
      <div class="form-grid">
        <div class="form-group">
          <label>Client Name</label>
          <input type="text" placeholder="Client name" required>
        </div>
        <div class="form-group">
          <label>Date</label>
          <input type="date" required>
        </div>
        <div class="form-group">
          <label>Price Target ($)</label>
          <input type="number" step="0.01" placeholder="0.00">
        </div>
        <div class="form-group">
          <label>Service Level</label>
          <select>
            <option value="" disabled selected>Select level</option>
            <option>Atomix Economy</option>
            <option>Atomix Ground</option>
          </select>
        </div>
        <div class="form-group">
          <label>Warehouse Location</label>
          <select>
            <option value="" disabled selected>Select location</option>
            <option>Milwaukee</option>
            <option>Salt Lake City</option>
            <option>Baltimore</option>
            <option>MKE &amp; SLC</option>
          </select>
        </div>
        <div class="form-group">
          <label>Desired Margin %</label>
          <input type="number" step="0.1" placeholder="0.0" id="order-margin">
        </div>
        <div class="form-group">
          <label>Sales Rep</label>
          <input type="text" placeholder="Sales rep name" required>
        </div>
        <div class="form-group full-width">
          <label>Notes / Observations</label>
          <textarea placeholder="Trends, anomalies, insights..."></textarea>
        </div>
        <div class="form-group full-width">
          <label>Attachments</label>
          <div class="file-upload-area" id="order-upload-area">
            <input type="file" id="order-file-input" multiple accept=".pdf,.xlsx,.xls,.csv" style="display:none" onchange="handleOrderFiles(this)">
            <div class="upload-dropzone" onclick="document.getElementById('order-file-input').click()" id="order-dropzone">
              <div class="upload-icon">&#8682;</div>
              <div class="upload-text">Click to upload or drag & drop files</div>
              <div class="upload-hint">PDFs and Excel documents — multiple files supported</div>
            </div>
            <div class="file-list" id="order-file-list"></div>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-ghost" onclick="closeModal('orders')">Cancel</button>
        <button type="submit" class="btn btn-primary">Log Analysis &rarr;</button>
      </div>
    </form>

    <div class="log-section">
      <div class="log-title">Order Analysis Log</div>
      <table class="log-table">
        <thead>
          <tr>
            <th>Client</th>
            <th>Date</th>
            <th>Target</th>
            <th>Service</th>
            <th>Warehouse</th>
            <th>Margin %</th>
            <th>Sales Rep</th>
            <th>Files</th>
          </tr>
        </thead>
        <tbody id="orders-log-body">
        </tbody>
      </table>
      <div class="log-empty" id="orders-empty">No analyses logged yet.</div>
    </div>
  </div>
</div>

<!-- ════════════════════════════════════════
     MODAL — Client Rate Card Adjustments
     ════════════════════════════════════════ -->
<div class="modal-overlay" id="modal-ratecard">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('ratecard')">&times;</button>
    <div class="module-label">Module</div>
    <div class="module-title">Client Rate Card Adjustments</div>

    <form id="form-ratecard" onsubmit="return submitRateCard(event)">
      <div class="form-grid">
        <div class="form-group">
          <label>Client Name</label>
          <input type="text" placeholder="Client name" required>
        </div>
        <div class="form-group">
          <label>Requested Date</label>
          <input type="date" required>
        </div>
        <div class="form-group">
          <label>Service Level</label>
          <select required>
            <option value="" disabled selected>Select level</option>
            <option>Atomix Economy</option>
            <option>Atomix Ground</option>
          </select>
        </div>
        <div class="form-group">
          <label>Adjustment Type</label>
          <select required>
            <option value="" disabled selected>Select type</option>
            <option>Remove Carrier</option>
            <option>Add Carrier</option>
          </select>
        </div>
        <div class="form-group">
          <label>Submitted By</label>
          <input type="text" placeholder="Your name">
        </div>
        <div class="form-group full-width">
          <label>Justification / Notes</label>
          <textarea placeholder="Reason for adjustment, contract references, etc."></textarea>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-ghost" onclick="closeModal('ratecard')">Cancel</button>
        <button type="submit" class="btn btn-primary">Log Adjustment &rarr;</button>
      </div>
    </form>

    <div class="log-section">
      <div class="log-title">Rate Card Log</div>
      <table class="log-table">
        <thead>
          <tr>
            <th>Client</th>
            <th>Req. Date</th>
            <th>Service Level</th>
            <th>Type</th>
            <th>Submitted By</th>
          </tr>
        </thead>
        <tbody id="ratecard-log-body">
        </tbody>
      </table>
      <div class="log-empty" id="ratecard-empty">No adjustments logged yet.</div>
    </div>
  </div>
</div>

<!-- ════════ SCRIPTS ════════ -->
<script>
  /* ── Modal open / close ── */
  function openModal(id) {
    document.getElementById('modal-' + id).classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  function closeModal(id) {
    document.getElementById('modal-' + id).classList.remove('active');
    document.body.style.overflow = '';
  }

  // Close on overlay click
  document.querySelectorAll('.modal-overlay').forEach(overlay => {
    overlay.addEventListener('click', e => {
      if (e.target === overlay) {
        overlay.classList.remove('active');
        document.body.style.overflow = '';
      }
    });
  });

  // Close on Escape
  document.addEventListener('keydown', e => {
    if (e.key === 'Escape') {
      document.querySelectorAll('.modal-overlay.active').forEach(m => {
        m.classList.remove('active');
      });
      document.body.style.overflow = '';
    }
  });

  /* ── Auto-calculations ── */


  /* ── Form Submissions ── */
  function getInputValues(form) {
    return Array.from(form.querySelectorAll('input, select, textarea')).map(el => el.value);
  }

  function submitCredit(e) {
    e.preventDefault();
    const f = document.getElementById('form-credit');
    const vals = getInputValues(f);
    const [client, date, ref, amount, reason, by] = vals;

    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${client}</td>
      <td>${date}</td>
      <td>${ref || '—'}</td>
      <td>$${parseFloat(amount).toFixed(2)}</td>
      <td>${reason}</td>
      <td>${by || '—'}</td>
    `;
    document.getElementById('credit-log-body').appendChild(row);
    document.getElementById('credit-empty').style.display = 'none';
    row.classList.add('flash');
    f.reset();
    return false;
  }

  function submitPackaging(e) {
    e.preventDefault();
    const f = document.getElementById('form-packaging');
    const vals = getInputValues(f);
    const [client, date, sku, type, startDate, cost, requestedBy] = vals;

    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${client}</td>
      <td>${date}</td>
      <td>${sku || '—'}</td>
      <td>${type}</td>
      <td>${startDate}</td>
      <td>$${parseFloat(cost || 0).toFixed(2)}</td>
    `;
    document.getElementById('packaging-log-body').appendChild(row);
    document.getElementById('packaging-empty').style.display = 'none';
    row.classList.add('flash');
    f.reset();
    return false;
  }

  /* ── File Upload Handling ── */
  let orderFiles = [];

  function handleOrderFiles(input) {
    for (const file of input.files) {
      orderFiles.push(file);
    }
    renderOrderFiles();
    input.value = '';
  }

  function removeOrderFile(index) {
    orderFiles.splice(index, 1);
    renderOrderFiles();
  }

  function renderOrderFiles() {
    const list = document.getElementById('order-file-list');
    list.innerHTML = '';
    orderFiles.forEach((file, i) => {
      const size = file.size < 1024 ? file.size + ' B'
        : file.size < 1048576 ? (file.size / 1024).toFixed(1) + ' KB'
        : (file.size / 1048576).toFixed(1) + ' MB';
      const item = document.createElement('div');
      item.className = 'file-item';
      item.innerHTML = `
        <div class="file-item-name">
          <span style="color:var(--accent)">&#128206;</span>
          <span>${file.name}</span>
          <span class="file-item-size">${size}</span>
        </div>
        <button type="button" class="file-remove" onclick="removeOrderFile(${i})">&times;</button>
      `;
      list.appendChild(item);
    });
  }

  // Drag & drop support
  const dropzone = document.getElementById('order-dropzone');
  if (dropzone) {
    dropzone.addEventListener('dragover', e => { e.preventDefault(); dropzone.classList.add('drag-over'); });
    dropzone.addEventListener('dragleave', () => dropzone.classList.remove('drag-over'));
    dropzone.addEventListener('drop', e => {
      e.preventDefault();
      dropzone.classList.remove('drag-over');
      for (const file of e.dataTransfer.files) { orderFiles.push(file); }
      renderOrderFiles();
    });
  }

  function submitOrder(e) {
    e.preventDefault();
    const f = document.getElementById('form-orders');
    const inputs = f.querySelectorAll('input:not([type="file"]), select, textarea');
    const vals = Array.from(inputs).map(el => el.value);
    const [client, date, priceTarget, serviceLevel, warehouse, margin, salesRep, notes] = vals;

    const fileCount = orderFiles.length;
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${client}</td>
      <td>${date}</td>
      <td>${priceTarget ? '$' + parseFloat(priceTarget).toFixed(2) : '—'}</td>
      <td>${serviceLevel || '—'}</td>
      <td>${warehouse || '—'}</td>
      <td>${margin ? margin + '%' : '—'}</td>
      <td>${salesRep || '—'}</td>
      <td>${fileCount > 0 ? fileCount + ' file' + (fileCount > 1 ? 's' : '') : '—'}</td>
    `;
    document.getElementById('orders-log-body').appendChild(row);
    document.getElementById('orders-empty').style.display = 'none';
    row.classList.add('flash');
    f.reset();
    orderFiles = [];
    renderOrderFiles();
    return false;
  }
  function submitRateCard(e) {
    e.preventDefault();
    const f = document.getElementById('form-ratecard');
    const vals = getInputValues(f);
    const [client, date, serviceLevel, type, submittedBy, notes] = vals;

    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${client}</td>
      <td>${date}</td>
      <td>${serviceLevel || '—'}</td>
      <td>${type}</td>
      <td>${submittedBy || '—'}</td>
    `;
    document.getElementById('ratecard-log-body').appendChild(row);
    document.getElementById('ratecard-empty').style.display = 'none';
    row.classList.add('flash');
    f.reset();
    return false;
  }
</script>

</body>
</html>
